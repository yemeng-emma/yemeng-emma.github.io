<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Meng Ye - Research Pipelines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Meng Ye</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../research/publication.html">
 <span class="dropdown-text">Publications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/pipeline.html">
 <span class="dropdown-text">Research projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/talks.html">
 <span class="dropdown-text">Presentations and Talks</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../teaching/course.html">
 <span class="dropdown-text">Courses Taught</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../teaching/evaluation.html">
 <span class="dropdown-text">Teaching Evaluation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../awards.html"> 
<span class="menu-text">Awards and Grants</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../services.html"> 
<span class="menu-text">Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/yemeng-emma/bigdata4publicgood" title="" class="quarto-navigation-tool px-1" aria-label="github"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/meng-ye-b626a439/" title="" class="quarto-navigation-tool px-1" aria-label="linkedin"><i class="bi bi-linkedin"></i></a>
    <a href="https://scholar.google.com/citations?user=w8lJ-jEAAAAJ&amp;hl=en" title="" class="quarto-navigation-tool px-1" aria-label="google scholar"><i class="bi bi-mortarboard"></i></a>
    <a href="https://x.com/MengYe_Emma" title="" class="quarto-navigation-tool px-1" aria-label="X"><i class="bi bi-twitter"></i></a>
    <a href="mailto:mye2@gsu.edu" title="" class="quarto-navigation-tool px-1" aria-label="email"><i class="bi bi-envelope"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Research Pipelines</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../research/publication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Publications</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../research/pipeline.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2. Research Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../research/talks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Presentations and Talks</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Research Pipelines</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
.smallnote {
  font-size: 0.85em;
  color: #555;
  display: block;
  margin-top: 0.4em;
}
.subtitle {
  font-size: 0.9em;
  font-weight: bold;
  display: block;
  margin-top: 0.4em;
}
</style>
<p>My research examines how public and nonprofit organizations adapt amid blurring sector boundaries, government retrenchment, and shifting policy contexts. I organize my work into four research pipelines, each addressing a critical aspect of nonprofit and public management.</p>
<section id="pipeline-1-nonprofit-commercialization-and-performance-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="pipeline-1-nonprofit-commercialization-and-performance-outcomes">Pipeline 1<br>Nonprofit Commercialization and Performance Outcomes</h2>
<blockquote class="blockquote">
<p><strong>Dissertation: Nonprofit Commercialization – Three Essays on Its Implications for Social Mission, Access Disparities, and Public Perceptions</strong></p>
</blockquote>
<p><strong><em>1. How Does Commercialization Impact Nonprofit Performance and Service Accessibility? Differentiating Mission-Related and Unrelated Earned Income</em></strong><br>
<span class="subtitle">Status:</span> Accepted for 2025 NML-ESS Nonprofit Early Scholars Fellowship, preparing for submission<br>
<span class="subtitle">Introduction:</span> This paper investigates how commercialization affects nonprofit performance and access to services by distinguishing between mission-related business income (RBI) and mission-unrelated business income (UBI). Using panel data from U.S. arts and culture nonprofits between 2010 and 2021, it applies hierarchical panel analysis to test how revenue strategies shape both overall attendance and free access ratios. Results indicate that RBI supports attendance but reduces free service provision, while UBI is associated with declines in both performance and accessibility. The study highlights the dual role of commercialization in strengthening financial sustainability while potentially narrowing equitable access.</p>
<p><strong><em>2. Nonprofit Commercialization in England’s Health and Social Care: Impact on Quality Rating and the Access Disparity</em></strong><br>
<span class="subtitle">Status:</span> Accepted for 2025 ARNOVA Doctoral Seminar, writing<br>
<span class="subtitle">Introduction:</span> This essay examines the effects of nonprofit commercialization in the English health and social care sector. Drawing on data from the Care Quality Commission, Charity Commission annual returns, and the Index of Multiple Deprivation, the study analyzes over 47,000 nonprofit service sites. Hierarchical ordered logit regression is used to test how RBI and UBI influence service quality and accessibility. Findings suggest RBI improves quality ratings, whereas UBI contributes to lower ratings. Both income types are linked to service provision in less deprived areas, raising equity concerns. The paper advances debates on mission drift and nonprofit accountability in social care.</p>
<p><strong><em>3. How Do Individual Donors Respond to Nonprofit Commercialization and Related Context and Framing: A Conjoint Survey Experiment Study</em></strong><br>
<span class="subtitle">Status:</span> In preparation<br>
<span class="subtitle">Introduction:</span> This study explores donor reactions to nonprofit commercialization through a nationally representative conjoint experiment of 1,200 U.S. respondents. The experiment manipulates levels of RBI and UBI across nonprofit subsectors, alongside contextual factors such as financial stress and expenditure use. Results show donors prefer organizations with lower levels of commercialization but are more supportive when revenues are framed as necessary for sustaining programs under financial pressure. The study provides causal evidence on how commercialization strategies and framing shape donor preferences, offering practical insights for nonprofit fundraising and theoretical contributions to social exchange and signaling theories.</p>
</section>
<section id="pipeline-2-government-retrenchment-publicness-and-organizational-performance" class="level2">
<h2 class="anchored" data-anchor-id="pipeline-2-government-retrenchment-publicness-and-organizational-performance">Pipeline 2<br>Government Retrenchment, Publicness, and Organizational Performance</h2>
<p><strong><em>1. Do Social Enterprises Fulfill Their Social Promise?</em></strong><br>
<span class="subtitle">Status:</span> Forthcoming, Public Performance &amp; Management Review<br>
<span class="subtitle">Introduction:</span> This paper examines whether Community Interest Companies (CICs), a social enterprise form in England, deliver on their promise of combining commercial efficiency with social value. Using ordered logit regression on Care Quality Commission quality ratings, we compare CICs to public, nonprofit, for-profit, and family providers in the social care sector. Results show CICs consistently outperform for-profit providers and perform on par with nonprofits and government organizations. These findings suggest that CICs can effectively balance social purpose and business orientation, advancing understanding of how ownership forms shape organizational performance and informing debates about social enterprise policy design.</p>
<p><strong><em>2. Government versus Social Enterprise: Comparing the Quality of Government-Run and Social Enterprise Spin-Out Organizations in English Health and Social Care</em></strong><br>
<span class="subtitle">Status:</span> R&amp;R, Journal of Social Policy<br>
<span class="subtitle">Introduction:</span> This study investigates performance outcomes when government-run services are transitioned into social enterprises, specifically spin-out CICs. Drawing on Care Quality Commission data and using ordered logit regression, we compare service quality ratings between government providers, spin-out CICs, and independently established CICs. Findings reveal that spin-out CICs outperform government providers but fall short of independent CICs. The analysis employs publicness theory to explain these performance differences, highlighting the hybrid nature of spin-outs that retain public sector legacies while embracing market logic. The paper contributes to scholarship on public service reform and offers policymakers insights on organizational design choices.</p>
<p><strong><em>3. Joint Private Provision of Social Good: A Mixed-Method Study of Nonprofit-Business Collaboration</em></strong><br>
<span class="subtitle">Status:</span> Under review<br>
<span class="subtitle">Introduction:</span> This paper explores cross-sector collaboration in the context of Chinese charitable trusts, a new institutional arrangement introduced by the 2016 Charity Law. Using a mixed-method design, we analyze 1,227 charitable trust filings and conduct 31 interviews with key stakeholders. Quantitative analysis shows that collaborations between nonprofits and for-profit trust companies are more likely with larger asset size, longer duration, and over time as the system matures. Qualitative findings reveal additional drivers such as innovation and policy advocacy, but also highlight cases of cost-ineffective collaboration. This study advances theories of resource dependence and institutional design in cross-sector partnerships.</p>
</section>
<section id="pipeline-3-nonprofit-finance-accountability-and-sustainability" class="level2">
<h2 class="anchored" data-anchor-id="pipeline-3-nonprofit-finance-accountability-and-sustainability">Pipeline 3<br>Nonprofit Finance, Accountability, and Sustainability</h2>
<p><strong><em>1. How Does Reduced Reporting Burden in 990-EZ Impact Nonprofits’ Financial Health?</em></strong><br>
<span class="subtitle">Status:</span> Under review<br>
<span class="subtitle">Introduction:</span> This paper investigates the trade-off between accountability and administrative burden in nonprofit financial reporting. Using IRS Statistics of Income data for the full 501(c)(3) population (2012–2023), we apply a double regression discontinuity design based on the revenue and asset thresholds that determine eligibility for the simplified 990-EZ form. We test whether reduced disclosure requirements affect survival rates and financial health. Findings suggest that lighter reporting lowers compliance costs but may compromise financial sustainability and transparency over time. The study contributes to theories of nonprofit accountability and informs current debates around regulatory reform and trust-based philanthropy.</p>
<p><strong><em>2. Factors Driving Nonprofit Financial Investment Decisions and Income: A Panel Data Analysis</em></strong><br>
<span class="subtitle">Status:</span> Under review<br>
<span class="subtitle">Introduction:</span> This research note examines nonprofit investment strategies in China, where foundations are legally permitted but often constrained by institutional oversight. Using panel data from Chinese foundations (2018–2022), we analyze factors associated with investment participation and income. Results show limited engagement, with modest financial returns among participating organizations. Regression models reveal that internal factors such as leverage and financial flexibility, along with external conditions including political connections, strongly shape investment decisions. These findings deepen understanding of nonprofit financial management in state-regulated environments, extending resource dependence and institutional theories to the domain of nonprofit investment practices in emerging economies.</p>
<p><strong><em>3. Does Commercialization Improve Nonprofits’ Financial Health? A Quasi-Experimental Design</em></strong><br>
<span class="subtitle">Status:</span> In preparation<br>
<span class="subtitle">Introduction:</span> In response to declining donations and government support, nonprofits increasingly pursue commercialization, but its financial consequences remain unclear. Drawing on resource dependence theory, we argue that commercialization may strain nonprofits by redirecting resources toward business activities misaligned with their missions, increasing costs and risks. Using panel data from 5,000 U.S. arts and culture nonprofits (2009–2019), we apply an instrumental variable approach leveraging local accommodation industry employment growth. Results show commercialization reduces cash reserves and unrestricted net assets, though it does not increase debt burdens. The study advances understanding of commercialization’s trade-offs for sustainability and mission integrity.</p>
</section>
<section id="pipeline-4-policy-regulation-and-global-civil-society" class="level2">
<h2 class="anchored" data-anchor-id="pipeline-4-policy-regulation-and-global-civil-society">Pipeline 4<br>Policy, Regulation, and Global Civil Society</h2>
<p><strong><em>1. Enforcing Boundaries: China’s Overseas NGO Law and Operational Constraints for Global Civil Society</em></strong><br>
<span class="subtitle">Status:</span> Under review<br>
<span class="subtitle">Introduction:</span> This paper analyzes the effects of China’s 2016 Overseas NGO (ONGO) Law on international civil society. Using a mixed-method design, we combine Bayesian analysis of administrative data on all registered INGOs with comparative case studies of two environmental NGOs. Findings show that organizational mission, issue area, and pre-existing relationships with local officials strongly influence the degree of operating space. While some INGOs face strict constraints, others adapt through collaboration and alignment with government priorities. The study contributes to scholarship on authoritarian governance and shrinking civic space, offering insights into how states selectively constrain and enable international NGOs.</p>
<p><strong><em>2. Building an Enabling Legal Environment: Laws and Policies on Social Enterprises in China</em></strong><br>
<span class="subtitle">Status:</span> Published<br>
<span class="subtitle">Introduction:</span> This article provides a systematic analysis of the evolving legal and policy frameworks for social enterprises in China. It reviews national-level regulations and compares three local accreditation models, assessing their effectiveness against the UK’s Social Enterprise Mark as an international benchmark. Findings show that while Chinese policymakers drew on global frameworks, local adaptations have produced fragmented accreditation practices and limited recognition of social enterprises. The study identifies gaps in the legal environment and suggests directions for reform, contributing to comparative research on social enterprise policy and informing ongoing debates about fostering inclusive, sustainable social innovation.</p>
<p><strong><em>3. Unlocking the Impact of Charity Law on Commercialization of Charitable Organizations: Evidence from a Quasi-Experiment Design</em></strong><br>
<span class="subtitle">Status:</span> Under review<br>
<span class="subtitle">Introduction:</span> This study examines how China’s 2016 Charity Law affected nonprofit commercialization. Using difference-in-differences analysis of 29,599 reports from 6,264 organizations (2010–2020), we compare revenue strategies of public and non-public charities before and after the law. Findings show both types reduced commercial revenues, but non-public charities retained more flexibility and thus sustained higher levels of commercialization. The results underscore how institutional design shapes organizational finance, extending resource dependence and institutional theories to regulated environments. The study provides practical implications for policymakers balancing accountability with autonomy in nonprofit governance.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>